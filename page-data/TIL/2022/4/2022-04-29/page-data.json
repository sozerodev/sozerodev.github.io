{"componentChunkName":"component---src-templates-blog-post-js","path":"/TIL/2022/4/2022-04-29/","result":{"data":{"site":{"siteMetadata":{"title":"soyoung's devLog","author":"soyoung kim","siteUrl":"https://sozerodev.github.io","comment":{"disqusShortName":"","utterances":"sozerodev/sozerodev.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"84425ff3-f44a-509e-9586-6af41122c035","excerpt":"노드 cli모듈을 노드 모듈에서 불러 쓰기 spawn함수를 사용하여 gltf-transform 이라는 노드 모듈을 사용해야 했다. 비동기가 중심인 node이지만 기존의 소스코드에서 해당 모듈을 사용하려면 동기방식으로 사용해야 했기 때문에 spawn이 아닌 spawnsync를 사용함. 보통 뒤에 가 붙으면 비동기가 아닌 동기방식이라 보면 된다 함. 노드 모듈 안에 노드 모듈을 불러다 쓸 수 있나..?? 싶었는데 된다. \n내가 사용하려는 gltf-transform의 경우 cli…","html":"<h1 id=\"노드-cli모듈을-노드-모듈에서-불러-쓰기\" style=\"position:relative;\"><a href=\"#%EB%85%B8%EB%93%9C-cli%EB%AA%A8%EB%93%88%EC%9D%84-%EB%85%B8%EB%93%9C-%EB%AA%A8%EB%93%88%EC%97%90%EC%84%9C-%EB%B6%88%EB%9F%AC-%EC%93%B0%EA%B8%B0\" aria-label=\"노드 cli모듈을 노드 모듈에서 불러 쓰기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>노드 cli모듈을 노드 모듈에서 불러 쓰기</h1>\n<ul>\n<li>spawn함수를 사용하여 <a href=\"https://github.com/donmccurdy/glTF-Transform\">gltf-transform</a> 이라는 노드 모듈을 사용해야 했다.</li>\n<li>비동기가 중심인 node이지만 기존의 소스코드에서 해당 모듈을 사용하려면 동기방식으로 사용해야 했기 때문에 spawn이 아닌 <a href=\"https://nodejs.org/api/child_process.html\">spawnsync</a>를 사용함.</li>\n<li>보통 뒤에 <code class=\"language-text\">sync</code>가 붙으면 비동기가 아닌 동기방식이라 보면 된다 함.</li>\n</ul>\n<p>노드 모듈 안에 노드 모듈을 불러다 쓸 수 있나..?? 싶었는데 된다. </br>\n내가 사용하려는 gltf-transform의 경우 cli외에도 여러 편리한 함수를 제공해주었지만 그걸 활용하는 것 보다도 </br>\ncli에서 명시된 기능만으로도 내가 원하는 기능을 충분히 더 간편하게 활용할 수 있을 것 같아서 최대한 cli를 쓰는 방법을 찾게 되었고 성공했다.\n</br></br>\n방법은 생각보다 간단(하였으나 나는 오래걸렸다.)</br></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 900px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABaklEQVQoz52S23KCQBBEeU7kotwWlouIgihWwAQ1GrWilv//R52ZxeQ9PpyqnWYZeqbRTDvAyItgOeEfuuVCHwrCw4DOA8vrMR2CatNWuv6rE3yX0aJsjrrdYXu8oTtckOZzyOUJwfIMUewQvd0Rrm4Iiw6y2iNYnCBXF4TTNUTeoPs8IxoXeDEcauhDY3eezCCiHL6cKLemm8CwpcL0UoXhkO6R7qawxAQm13YIVyT9VNTMGAlq6MdwghQinoLdxnmFZFLRV0vEE6qzEjKd0bNSkZAWxDnCtIAYV/DjmXqXTblhBs0NxuowX3Vq5M3XVdFsjvjYf2O9PWPZ7FTdbk/Yne4o63cs2gOy9oq83mK2aOHzhIQ2dCXYpUm22XIfBtmnsHSqWePgjMe5r0OlWbZ4BCkxpFXxujS+MLB8ldqr2S/2//RJv9IfoDk0cjqraV8VplWjxn+OseqhcSB8YHgXHiX9DNyUe/wABVPvP37W4zoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sharp 에러\"\n        title=\"sharp 에러\"\n        src=\"/static/79e9cc83ed25929b216ef0326f9aa9a1/1cfc2/gltf-transform-bin.png\"\n        srcset=\"/static/79e9cc83ed25929b216ef0326f9aa9a1/5a46d/gltf-transform-bin.png 300w,\n/static/79e9cc83ed25929b216ef0326f9aa9a1/0a47e/gltf-transform-bin.png 600w,\n/static/79e9cc83ed25929b216ef0326f9aa9a1/1cfc2/gltf-transform-bin.png 900w\"\n        sizes=\"(max-width: 900px) 100vw, 900px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install @gltf-transform</code></pre></div>\n<p>을 사용할 경우 해당 프로젝트 내 node_module에 @gltf-transform 폴더가 생길 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> normPath <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">프로젝트경로의node_module경로/@gltf-transform/cli/bin/cli.js</span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token function\">spawnSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>normPath<span class=\"token punctuation\">,</span> <span class=\"token string\">'etc1s'</span><span class=\"token punctuation\">,</span> exportedGlbPath<span class=\"token punctuation\">,</span> exporedKtxPath<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>방식으로 실행시켜주면 끝!</p>\n<p>혹시 @gltf-transform/cli에 bin이 없다면 해당 패키지를 삭제하고 다시 인스톨 해보는 것을 추천</p>\n<h3 id=\"근데-etc1s랑-uastc의-차이는-뭔데\" style=\"position:relative;\"><a href=\"#%EA%B7%BC%EB%8D%B0-etc1s%EB%9E%91-uastc%EC%9D%98-%EC%B0%A8%EC%9D%B4%EB%8A%94-%EB%AD%94%EB%8D%B0\" aria-label=\"근데 etc1s랑 uastc의 차이는 뭔데 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>근데 etc1s랑 uastc의 차이는 뭔데?</h3>\n<p>gltf-transform에서 gltf의 텍스쳐를 ktx2방식으로 압축하는데 있어서 <code class=\"language-text\">etc1s</code>와 <code class=\"language-text\">uastc</code>라는 두 가지 옵션이 존재한다. </br>\netc1s는 다소 원본보다 낮은 퀄리티와 낮은 용량, uastc는 높은 퀄리티와 높은 용량으로 텍스쳐를 압축해준다. </br>\n처음에 uastc방식으로 gltf를 압축하면서 용량이 오히려 커진 것을 보고 당황했다..(compress해준다면서 용량이 왜 늘어나는건데?ㅠ) </br>\n퀄리티가 다소 떨어져도 웹에 올리면서 성능을 떨어뜨릴 수 없기 때문에 etc1s방식으로 사용하게 됨.</p>","frontmatter":{"title":"2022-04-29 TIL","date":"April 29, 2022","category":"TIL"}}},"pageContext":{"slug":"/TIL/2022/4/2022-04-29/","previous":{"fields":{"slug":"/TIL/2022/4/2022-04-28TIL/"},"frontmatter":{"title":"2022-04-28 TIL","category":"TIL","draft":false}},"next":null}},"staticQueryHashes":["3128451518","521680639"]}